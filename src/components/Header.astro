---
import Config from '../../astro.config.mjs'
import {getRelativeLocaleUrl} from "astro:i18n";
import HeaderLink from './HeaderLink.astro';
import { siteTitle } from '@root/consts';
import { headerMenu } from '@root/header';

const homeURL = getRelativeLocaleUrl(Astro.currentLocale, "");

const menuLocale =  headerMenu[Astro.currentLocale] ? Astro.currentLocale : Config.i18n.fallback[Astro.currentLocale] || Config.i18n?.defaultLocale
console.log("file: Header.astro:11 ~ menuLocale:", menuLocale)

const headerMenuItems = headerMenu[menuLocale].items

const { pathname } = Astro.url;
const homeIsCurrent = pathname === homeURL ? 'page' : '' ;
---

<header>
	<nav>
		<h2><a href="/">{siteTitle}</a></h2>
		<div class="internal-links">
			<HeaderLink href="/">Home</HeaderLink>
			<HeaderLink href="/blog">Blog</HeaderLink>
			<HeaderLink href="/about">About</HeaderLink>
		</div>
		<ul class="header__list">
			<li class="header__home-item">
				<a
					href={homeURL}
					aria-current={homeIsCurrent ? homeIsCurrent : undefined}
				>
					{siteTitle}
				</a>
			</li>
			{headerMenuItems.map((item) => (
				<HeaderLink href={item.path}>{item.label}</HeaderLink>
			))}
		</ul>
	</nav>
</header>

<style>
	.header__list{
		display: flex;
		flex-wrap: wrap;
		gap: 1em;
		max-width: 100%;
		overflow-x: auto;
	}
	.header__home-item{
		flex-grow: 1;
	}
</style>